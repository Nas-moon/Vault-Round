<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vault Round</title>
  <style>
    body {
      background-color: #0c0c0c;
      color: white;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1 {
      color: #00f3ff;
    }
    select, input[type="password"] {
      padding: 10px;
      margin: 10px;
      border-radius: 8px;
      font-size: 16px;
      border: none;
      width: 200px;
      text-align: center;
    }
    button {
      padding: 10px 20px;
      background-color: #00f3ff;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      color: #000;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background-color: #00c2cc;
    }
    .vaults-container {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 30px;
    }
    .vault-box {
      background-color: #1c1c1c;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 10px #00f3ff;
      width: 300px;
    }
    .message {
      height: 22px;
      margin-top: 10px;
      font-size: 16px;
    }
    .scoreboard {
      margin-top: 40px;
      background-color: #1c1c1c;
      padding: 20px;
      border-radius: 15px;
      width: 90%;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }
    .scoreboard h3 {
      margin-bottom: 10px;
      color: #00f3ff;
    }
    .scoreboard pre {
      text-align: left;
      background-color: #111;
      padding: 10px;
      border-radius: 10px;
      overflow-x: auto;
    }
    .back-btn {
      position: fixed;
      top: 20px;
      left: 20px;
      background-color: #444;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
    }
    .back-btn:hover {
      background-color: #666;
    }
  </style>
</head>
<body>
  <button class="back-btn" onclick="goBack()">‚Üê Back</button>
  <h1>üîê Vault Challenge</h1>

  <label for="teamSelector">Select Team:</label>
  <select id="teamSelector" onchange="updateVaultStatus()"></select>

  <div class="vaults-container">
    <!-- RED Vault -->
    <div class="vault-box" style="border-top: 4px solid red;">
      <h2>üî¥ Red Vault</h2>
      <input type="password" id="input-red" maxlength="6" placeholder="‚óè‚óè‚óè‚óè‚óè‚óè" />
      <br>
      <button onclick="attemptVault('red')">Unlock</button>
      <div class="message" id="message-red"></div>
    </div>

    <!-- BLUE Vault -->
    <div class="vault-box" style="border-top: 4px solid blue;">
      <h2>üîµ Blue Vault</h2>
      <input type="password" id="input-blue" maxlength="6" placeholder="‚óè‚óè‚óè‚óè‚óè‚óè" />
      <br>
      <button onclick="attemptVault('blue')">Unlock</button>
      <div class="message" id="message-blue"></div>
    </div>

    <!-- YELLOW Vault -->
    <div class="vault-box" style="border-top: 4px solid gold;">
      <h2>üü° Yellow Vault</h2>
      <input type="password" id="input-yellow" maxlength="6" placeholder="‚óè‚óè‚óè‚óè‚óè‚óè" />
      <br>
      <button onclick="attemptVault('yellow')">Unlock</button>
      <div class="message" id="message-yellow"></div>
    </div>
  </div>

  <div class="scoreboard">
    <h3>üìä Vault Scoreboard</h3>
    <pre id="scoreDisplay"></pre>
  </div>
   <input type="text" id="input-a" placeholder="Enter Code">
<button id="unlock-btn-a" onclick="attemptVault('a')">Unlock</button>
<button id="try-again-a" onclick="tryAgain('a')" style="display:none;">Try Again</button>
<p id="message-a"></p>

  <input type="text" id="input-b" placeholder="Enter Code">
<button id="unlock-btn-b" onclick="attemptVault('b')">Unlock</button>
<button id="try-again-b" onclick="tryAgain('b')" style="display:none;">Try Again</button>
<p id="message-b"></p>

  <input type="text" id="input-c" placeholder="Enter Code">
<button id="unlock-btn-c" onclick="attemptVault('c')">Unlock</button>
<button id="try-again-c" onclick="tryAgain('c')" style="display:none;">Try Again</button>
<p id="message-c"></p>

  <script>
    const correctCodes = {
      red: "123456",
      blue: "654321",
      yellow: "112233"
    };

    let gameState = JSON.parse(localStorage.getItem("vaultGameState")) || {};
    let teamNames = JSON.parse(localStorage.getItem("teamNames")) || [];

    // Populate team dropdown
    const selector = document.getElementById("teamSelector");
    teamNames.forEach((name, index) => {
      const opt = document.createElement("option");
      opt.value = `team${index}`;
      opt.textContent = name;
      selector.appendChild(opt);
    });

    function updateVaultStatus() {
      ["red", "blue", "yellow"].forEach(vault => {
        const teamKey = selector.value;
        const attempts = gameState[teamKey]?.attempts[vault] ?? 3;
        const unlocked = gameState[teamKey]?.unlocked[vault];
        const msgBox = document.getElementById(`message-${vault}`);

        if (unlocked) {
          msgBox.style.color = "#00ff88";
          msgBox.innerText = "‚úÖ Vault already unlocked!";
        } else {
          msgBox.style.color = "yellow";
          msgBox.innerText = `Attempts left: ${attempts}`;
        }
      });
      updateScoreboard();
    }

    
        function attemptVault(vault) {
  const teamKey = selector.value;
  const inputField = document.getElementById(`input-${vault}`);
  const messageBox = document.getElementById(`message-${vault}`);
  const unlockBtn = document.getElementById(`unlock-btn-${vault}`);
  const tryAgainBtn = document.getElementById(`try-again-${vault}`);
  const team = gameState[teamKey];
  const input = inputField.value.trim();

  if (team.unlocked[vault]) {
    messageBox.style.color = "#00ff88";
    messageBox.innerText = "‚úÖ Already unlocked!";
    return;
  }

  if (team.attempts[vault] <= 0) {
    messageBox.style.color = "#ff4d4d";
    messageBox.innerText = "üö´ No attempts left!";
    return;
  }

  if (input === correctCodes[vault]) {
    team.unlocked[vault] = true;
    messageBox.style.color = "#00ff88";
    messageBox.innerText = "‚úÖ Vault unlocked!";
    team.history.push(`‚úÖ ${vault.toUpperCase()} Vault unlocked`);
  } else {
    team.attempts[vault] -= 1;
    messageBox.style.color = "#ff4d4d";
    messageBox.innerText = `‚ùå Incorrect! Attempts left: ${team.attempts[vault]}`;
    team.history.push(`‚ùå Tried ${vault.toUpperCase()} Vault`);
  }

  inputField.value = "";
  inputField.style.display = "none";
  unlockBtn.style.display = "none";

  // Show Try Again only if they have more attempts and haven‚Äôt unlocked
  if (!team.unlocked[vault] && team.attempts[vault] > 0) {
    tryAgainBtn.style.display = "inline-block";
  }

  localStorage.setItem("vaultGameState", JSON.stringify(gameState));
  updateVaultStatus();
}

    function tryAgain(vault) {
  document.getElementById(`input-${vault}`).style.display = "inline-block";
  document.getElementById(`unlock-btn-${vault}`).style.display = "inline-block";
  document.getElementById(`try-again-${vault}`).style.display = "none";
  document.getElementById(`message-${vault}`).innerText = "";
}


      if (input === correctCodes[vault]) {
        team.unlocked[vault] = true;
        messageBox.style.color = "#00ff88";
        messageBox.innerText = "‚úÖ Vault unlocked!";
        team.history.push(`‚úÖ ${vault.toUpperCase()} Vault unlocked`);
      } else {
        team.attempts[vault] -= 1;
        messageBox.style.color = "#ff4d4d";
        messageBox.innerText = `‚ùå Incorrect! Attempts left: ${team.attempts[vault]}`;
        team.history.push(`‚ùå Tried ${vault.toUpperCase()} Vault`);
      }

      localStorage.setItem("vaultGameState", JSON.stringify(gameState));
      updateVaultStatus();
    }

    function updateScoreboard() {
      const display = document.getElementById("scoreDisplay");
      display.textContent = "";

      Object.keys(gameState).forEach(teamKey => {
        const team = gameState[teamKey];
        display.textContent += `\nüî∏ ${team.name}:\n`;
        ["red", "blue", "yellow"].forEach(vault => {
          const status = team.unlocked[vault] ? "‚úÖ Opened" : `‚ùå Not Opened (Attempts Left: ${team.attempts[vault]})`;
          display.textContent += `  - ${vault.toUpperCase()} Vault: ${status}\n`;
        });
        display.textContent += `  History:\n    ${team.history.join("\n    ")}\n`;
      });
    }

    function goBack() {
      if (confirm("Go back to Team Setup? Game progress will be kept.")) {
        window.location.href = "index.html";
      }
    }

    window.onload = updateVaultStatus;
  </script>
</body>
</html>
